## HTTP返回码

- 200 成功
- 500 服务器内部错误
- 502 应用程序错误
- 504 应用程序超时

## HTTP 200 接口返回值结构

    {
       "meta":
       {
          "code": "业务码",
          "message": "状态信息"
       },
       "pagination": 
       {
          "rows_found": "找到的总记录数",
          "offset": "起始游标",
          "since": "往此游标向后追溯",
          "until": "往此游标向前追溯",
          "limit": "条数"
       },
       "data": ...
    }

*若无特殊说明以下接口响应结果指的是此结构的data字段的值。*

### 全局业务码

- 1000 请求成功
- 1001 请求失败
- 1002 需要认证（请求未带有access_token）
- 1003 无权限（access_token正确但是无权限）
- 1004 请求资源不存在
- 1005 不支持的方法
- 1006 请求不被接受（POST空数据、非JSON对象或编码错误）
- 1007 认证错误（access_token不正确）
- 1008 认证过期（access_token已经过期）
- 1009 账号未激活
- 1010 非该企业员工
- 1011 员工无操作权限
- 1012 分页大小超过限制
- 1013 密码不可用，必须强制更新
- 1999 未名错误

### 业务码

    OK = ResponseMeta(1000, '请求成功')
    ERROR = ResponseMeta(1001, '请求失败')
    AUTH_REQUIRED = ResponseMeta(1002, '需要认证（请求未带有access_token）')
    AUTH_FORBIDDEN = ResponseMeta(1003, '无权限（access_token正确但是无权限）')
    NOT_FOUND = ResponseMeta(1004, '请求资源不存在')
    METHOD_NOT_ALLOWED = ResponseMeta(1005, '不支持的方法')
    NOT_ACCEPTABLE = ResponseMeta(1006, '请求不被接受（POST空数据、非JSON对象或编码错误）')
    AUTH_UNAUTHORIZED = ResponseMeta(1007, '认证错误（access_token不正确）')
    AUTH_EXPIRED = ResponseMeta(1008, '认证过期（access_token已经过期）')
    NOT_ACTIVATED = ResponseMeta(1009, '账号未激活')
    INVALID_WORKER = ResponseMeta(1010, '非该企业员工')
    WORKER_FORBIDDEN = ResponseMeta(1011, '员工无操作权限')
    PAGE_SIZE_LIMIT = ResponseMeta(1012, '分页大小超过限制')
    PASSWORD_INVALID = ResponseMeta(1013, '密码不可用')
    UNKNOWN = ResponseMeta(1999, '未名错误')

    OAUTH2_UNAUTHORIZED_CLIENT = ResponseMeta(3010001, 'client_id不存在')
    OAUTH2_UNSUPPORTED_GRANT_TYPE = ResponseMeta(3010002, '不支持的grant_type')
    OAUTH2_INVALID_CLIENT = ResponseMeta(3010003, 'client secret错误')
    OAUTH2_ACCOUNT_NOT_FOUND = ResponseMeta(3010004, '账号不存在')
    OAUTH2_ACCOUNT_WRONG_PASSWORD = ResponseMeta(3010005, '账号密码错误')
    OAUTH2_ACCOUNT_WRONG_REFRESH_TOKEN = ResponseMeta(3010006, 'refresh_token错误')

    ACCOUNT_ATTRIBUTES_NOT_NULL = ResponseMeta(1010001, 'email，密码，联系信息等不能为空')
    ACCOUNT_EMAIL_INVALID = ResponseMeta(1010002, 'email格式错误')
    ACCOUNT_PASSWORD_INVALID = ResponseMeta(1010003, '密码格式错误')
    ACCOUNT_EXIST = ResponseMeta(1010004, '账号已经存在')
    ACCOUNT_SAVE_FAIL = ResponseMeta(1010005, '保存失败')
    ACCOUNT_ADD_FAIL = ResponseMeta(1010006, '创建失败')

    WORKER_ATTRIBUTES_NOT_NULL = ResponseMeta(1070001, '邀请email，联系信息不能为空')
    WORKER_EMAIL_INVALID = ResponseMeta(1070002, 'email格式错误')
    WORKER_STATUS_INVALID = ResponseMeta(1070003, '员工状态未定义')
    WORKER_NOT_FOUND = ResponseMeta(1070004, '员工不存在')
    WORKER_FOUNDER_CHANGE_FORBIDDEN = ResponseMeta(1070005, '创始人的绑定email不允许更改')
    WORKER_FOUNDER_REMOVE_FORBIDDEN = ResponseMeta(1070006, '创始人不允许删除')
    WORKER_FOUNDER_CHMOD_FORBIDDEN = ResponseMeta(1070007, '创始人不允许设置权限')
    WORKER_VERIFY_OBJECT_NOT_SUPPORT = ResponseMeta(1070008, '不支持审核的对象')
    WORKER_VERIFY_OBJECT_NOT_FOUND = ResponseMeta(1070009, '找不到对象')
    WORKER_VERIFY_FORBIDDEN = ResponseMeta(1070010, '不允许操作不属于贵公司资源')
    WORKER_VERIFY_TYPE_INVALID = ResponseMeta(1070011, '审核状态未定义')
    WORKER_ACCOUNT_NOT_BOUND = ResponseMeta(1070012, '员工没有绑定账号')
    WORKER_ACCOUNT_PASSWORD_INVALID = ResponseMeta(1070013, '密码不能为空')
    WORKER_INVITE_EMAIL_BOUND = ResponseMeta(1070014, '邮箱账号已经绑定')
    WORKER_CANNOT_REMOVE_SELF = ResponseMeta(1070015, '不能删除自己')

    CONTACT_ATTRIBUTES_NOT_NULL = ResponseMeta(1040001, '至少指定一个联系人名称')

    ADDRESS_ATTRIBUTES_NOT_NULL = ResponseMeta(1030001, '主地址不能为空')

    COMPANY_ATTRIBUTES_NOT_NULL = ResponseMeta(1090001, '企业名称不能为空')
    COMPANY_NOT_FOUND = ResponseMeta(1090002, '企业不存在')
    COMPANY_IN_USAGE = ResponseMeta(1090003, '企业正在使用不能删除')
    COMPANY_ENTITY_TYPE_INVALID = ResponseMeta(1090004, '企业类型错误')
    COMPANY_SEARCH_ARGUMENT_INVALID = ResponseMeta(1090005, '查询参数错误')

    FACTORY_ATTRIBUTES_NOT_NULL = ResponseMeta(1050001, '厂家名称不能为空')

    TRADER_ATTRIBUTES_NOT_NULL = ResponseMeta(1060001, '贸易商名称不能为空')

    PHOTO_MULTIPART_FILE_NULL = ResponseMeta(1020001, '上传文件数据为空')
    PHOTO_DATA_ERROR = ResponseMeta(1020002, '上传文件数据为空')
    PHOTO_FORMAT_FORBIDDEN = ResponseMeta(1020003, '不支持的图片类型')
    PHOTO_THUMB_MODE_INVALID = ResponseMeta(1020004, '缩略图方式未定义')
    PHOTO_ALIOSS_GET_FAIL = ResponseMeta(1020005, '无法获取原图数据')

    PRODUCT_INGREDIENT_INVALID = ResponseMeta(1080001, '工艺成分相加不为100')
    PRODUCT_INGREDIENT_SAVE_FAIL = ResponseMeta(1080002, '工艺成分保存失败')
    PRODUCT_INGREDIENT_NOT_NULL = ResponseMeta(1080003, '工艺成分不能为空')
    PRODUCT_CODE_EXIST = ResponseMeta(1080004, '产品编号已经存在')
    PRODUCT_ATTRIBUTES_NOT_NULL = ResponseMeta(1080005, '产品编号、图片、所属厂家和名称不能为空')
    PRODUCT_WAVEFORM_INVALID = ResponseMeta(1080006, '未定义的波形类型')
    PRODUCT_PATTERN_INVALID = ResponseMeta(1080007, '未定义的图案类型')

## 接口支持4种HTTP方法

- **GET** 获取对象
- **PUT** 替换和更新对象
- **POST** 创建新的对象
- **DELETE** 删除对象

## URL全局参数

- **q** 用于文本查询
- **limit**, **offset** 分页方式读取列表
- **until**, **since** 流方式读取列表

## OAuth2.0认证协议

### HTTP Headers 格式

    Content-Type: application/json  //请求内容都是以json格式提交
    Authorization: Bearer xxxxxxxx  //xxxxxxxx即为access_token

### 获取code

针对的是Client Types为public的应用，confidential的应用直接调用Token endpoint。

- /oauth2/authorize (Authorization endpoint)
- /oauth2/cb (Redirection endpoint)

### 获取access_token（Token endpoint）

- 请求地址：**POST /oauth2/token**
- 请求内容：
  - 首次认证
  
        {
           "client_id":"1", //Client Types为confidential
           "client_secret":"c4ca4238a0b923820dcc509a6f75849b",
           "grant_type":"password",
           "username":"email账号",
           "password":"账号密码"
        }
        
  - 刷新认证

        {
           "client_id":"1",
           "client_secret":"c4ca4238a0b923820dcc509a6f75849b",
           "grant_type":"refresh_token",
           "refresh_token":"首次认证获取的refresh_token"
        }

- 成功响应：

        {
           "token_type":"Bearer",
           "access_token":"认证码",
           "expires_in":"过期时长",
           "refresh_token":"只记录在client端，每次重新生成之后，之前的refresh_token会吊销",
        }
        
## URL 中的 me

在URL中 `{endpoint}/me` 表示获取当前认证用户的对象。如： `accounts/me` 表示获取当前认证用户的 `account` 对象。
